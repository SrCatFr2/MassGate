<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JustChat - Conecta con el mundo</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Sección de autenticación rediseñada -->
    <div id="auth-section">
        <div class="auth-background">
            <div class="auth-particles"></div>
            <div class="auth-gradient"></div>
        </div>
        
        <div class="auth-container">
            <!-- Header de bienvenida -->
            <div class="auth-header">
                <div class="logo-large">
                    <div class="logo-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <h1>JustChat</h1>
                </div>
                <p class="auth-subtitle">Conecta, chatea y comparte momentos únicos con personas de todo el mundo</p>
            </div>
            
            <!-- Contenedor de formularios -->
            <div class="auth-content">
                <!-- Formulario de Login -->
                <div class="auth-form active" id="login-form-container">
                    <div class="form-header">
                        <h2>¡Bienvenido de vuelta!</h2>
                        <p>Inicia sesión para continuar chateando</p>
                    </div>
                    
                    <form id="login-form" class="form">
                        <div class="input-group">
                            <div class="input-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <input type="email" id="login-email" placeholder="Tu email" required>
                            <label>Email</label>
                        </div>
                        
                        <div class="input-group">
                            <div class="input-icon">
                                <i class="fas fa-lock"></i>
                            </div>
                            <input type="password" id="login-password" placeholder="Tu contraseña" required>
                            <label>Contraseña</label>
                        </div>
                        
                        <button type="submit" class="btn-auth primary">
                            <span class="btn-text">Iniciar Sesión</span>
                            <div class="btn-loader">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                        </button>
                    </form>
                    
                    <div class="form-footer">
                        <p>¿Nuevo en JustChat? <button type="button" class="link-btn" id="show-register">Crear cuenta</button></p>
                    </div>
                </div>

                <!-- Formulario de Registro -->
                <div class="auth-form" id="register-form-container">
                    <div class="form-header">
                        <h2>¡Únete a la comunidad!</h2>
                        <p>Crea tu cuenta y comienza a chatear</p>
                    </div>
                    
                    <form id="register-form" class="form">
                        <div class="input-group">
                            <div class="input-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <input type="text" id="register-username" placeholder="Tu nombre de usuario" required minlength="3" maxlength="20">
                            <label>Nombre de usuario</label>
                        </div>
                        
                        <div class="input-group">
                            <div class="input-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <input type="email" id="register-email" placeholder="Tu email" required>
                            <label>Email</label>
                        </div>
                        
                        <div class="input-group">
                            <div class="input-icon">
                                <i class="fas fa-lock"></i>
                            </div>
                            <input type="password" id="register-password" placeholder="Crea una contraseña" required minlength="6">
                            <label>Contraseña</label>
                        </div>
                        
                        <button type="submit" class="btn-auth primary">
                            <span class="btn-text">Crear Cuenta</span>
                            <div class="btn-loader">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                        </button>
                    </form>
                    
                    <div class="form-footer">
                        <p>¿Ya tienes cuenta? <button type="button" class="link-btn" id="show-login">Iniciar sesión</button></p>
                    </div>
                </div>
            </div>
            
            <!-- Footer de autenticación -->
            <div class="auth-footer">
                <div class="features">
                    <div class="feature">
                        <i class="fas fa-bolt"></i>
                        <span>Chat en tiempo real</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-shield-alt"></i>
                        <span>Seguro y privado</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-mobile-alt"></i>
                        <span>Multiplataforma</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sección principal de chat -->
    <div id="chat-section" style="display: none;">
        <!-- Header principal -->
        <header class="main-header">
            <div class="header-left">
                <button class="mobile-menu-btn" id="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo">
                    <i class="fas fa-comments"></i>
                    <span>JustChat</span>
                </div>
            </div>
            
            <div class="header-center">
                <div class="search-container">
                    <i class="fas fa-search"></i>
                    <input type="text" id="global-search" placeholder="Buscar usuarios, salas o mensajes...">
                    <div id="search-results" class="search-results"></div>
                </div>
            </div>
            
            <div class="header-right">
                <div class="user-info" id="user-info">
                    <div class="user-avatar" id="header-user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <span class="username" id="header-username"></span>
                    <button class="user-menu-btn" id="user-menu-btn">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                <div class="user-dropdown" id="user-dropdown">
                    <button id="profile-btn"><i class="fas fa-user-cog"></i> Mi Perfil</button>
                    <button id="settings-btn"><i class="fas fa-cog"></i> Configuración</button>
                    <hr>
                    <button id="logout-btn"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</button>
                </div>
            </div>
        </header>

        <!-- Contenedor principal -->
        <div class="main-container">
            <!-- Sidebar compacta -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-layer-group"></i> Navegación</h3>
                    <button class="close-sidebar" id="close-sidebar">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <!-- Tabs de navegación -->
                <div class="nav-tabs">
                    <button class="nav-tab active" data-tab="rooms">
                        <i class="fas fa-hashtag"></i>
                        <span>Salas</span>
                    </button>
                    <button class="nav-tab" data-tab="users">
                        <i class="fas fa-users"></i>
                        <span>Usuarios</span>
                    </button>
                    <button class="nav-tab" data-tab="dms">
                        <i class="fas fa-envelope"></i>
                        <span>Directos</span>
                    </button>
                </div>

                <!-- Contenido de tabs -->
                <div class="tab-content">
                    <!-- Tab de salas -->
                    <div class="tab-pane active" id="rooms-tab">
                        <div class="tab-header">
                            <button class="btn-create" id="create-room-btn">
                                <i class="fas fa-plus"></i> Nueva Sala
                            </button>
                        </div>
                        <div class="items-list" id="rooms-list"></div>
                    </div>
                    
                    <!-- Tab de usuarios -->
                    <div class="tab-pane" id="users-tab">
                        <div class="tab-header">
                            <div class="mini-search">
                                <i class="fas fa-search"></i>
                                <input type="text" id="users-search" placeholder="Buscar usuarios...">
                            </div>
                        </div>
                        <div class="online-count">
                            <i class="fas fa-circle online"></i>
                            <span id="online-count">0 conectados</span>
                        </div>
                        <div class="items-list" id="users-list"></div>
                    </div>
                    
                    <!-- Tab de mensajes directos -->
                    <div class="tab-pane" id="dms-tab">
                        <div class="tab-header">
                            <div class="mini-search">
                                <i class="fas fa-search"></i>
                                <input type="text" id="dm-search" placeholder="Buscar conversaciones...">
                            </div>
                        </div>
                        <div class="items-list" id="dm-list"></div>
                    </div>
                </div>
            </aside>

            <!-- Área de chat principal -->
            <main class="chat-main">
                <!-- Estado inicial -->
                <div class="welcome-screen" id="welcome-screen">
                    <div class="welcome-content">
                        <div class="welcome-animation">
                            <i class="fas fa-comments-alt welcome-icon"></i>
                            <div class="welcome-particles"></div>
                        </div>
                        <h2>¡Hola, <span id="welcome-username"></span>!</h2>
                        <p>Selecciona una sala o inicia una conversación para comenzar a chatear</p>
                        <div class="quick-actions">
                            <button class="quick-btn" onclick="document.querySelector('[data-tab=rooms]').click()">
                                <i class="fas fa-hashtag"></i> Explorar Salas
                            </button>
                            <button class="quick-btn" onclick="document.querySelector('[data-tab=users]').click()">
                                <i class="fas fa-users"></i> Ver Usuarios
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Área de chat activa -->
                <div class="chat-area" id="chat-area" style="display: none;">
                    <!-- Header del chat -->
                    <div class="chat-header">
                        <div class="chat-info">
                            <div class="chat-avatar" id="chat-avatar">
                                <i class="fas fa-hashtag"></i>
                            </div>
                            <div class="chat-details">
                                <h3 id="current-chat-title">Sala General</h3>
                                <small id="chat-description">Descripción del chat</small>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <button class="chat-action-btn" id="chat-info-btn" title="Información">
                                <i class="fas fa-info-circle"></i>
                            </button>
                            <button class="chat-action-btn" id="search-messages-btn" title="Buscar mensajes">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Contenedor de mensajes -->
                    <div class="messages-container" id="messages-container">
                        <div class="messages-content" id="messages"></div>
                        <div class="typing-indicator" id="typing-indicator"></div>
                    </div>
                    
                    <!-- Input de mensaje -->
                    <div class="message-input-area">
                        <div class="message-input-container">
                            <button class="attachment-btn" title="Adjuntar archivo">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <div class="input-wrapper">
                                <input type="text" id="message-input" placeholder="Escribe tu mensaje..." disabled>
                                <button class="emoji-btn" title="Emojis">
                                    <i class="fas fa-smile"></i>
                                </button>
                            </div>
                            <button id="send-btn" class="send-btn" disabled>
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Modal para crear sala -->
        <div id="room-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-plus-circle"></i> Crear Nueva Sala</h3>
                    <button class="close-modal" onclick="closeRoomModal()">&times;</button>
                </div>
                <form id="create-room-form">
                    <div class="input-group">
                        <label>Nombre de la sala</label>
                        <input type="text" id="room-name" placeholder="Ej: sala-de-juegos" required>
                    </div>
                    <div class="input-group">
                        <label>Descripción</label>
                        <textarea id="room-description" placeholder="Describe de qué trata esta sala..."></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="closeRoomModal()">Cancelar</button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-plus"></i> Crear Sala
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal de perfil -->
        <div id="profile-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-user-cog"></i> Mi Perfil</h3>
                    <button class="close-modal" onclick="closeProfileModal()">&times;</button>
                </div>
                <div class="profile-content">
                    <!-- Foto de perfil actual -->
                    <div class="profile-picture-section">
                        <div class="current-profile-picture">
                            <img id="current-profile-img" src="" alt="Foto de perfil" style="display: none;">
                            <div id="current-profile-avatar" class="profile-avatar-large">
                                <i class="fas fa-user"></i>
                            </div>
                        </div>
                        <div class="profile-picture-actions">
                            <button type="button" class="btn-secondary" id="change-picture-btn">
                                <i class="fas fa-camera"></i> Cambiar Foto
                            </button>
                            <button type="button" class="btn-danger" id="remove-picture-btn" style="display: none;">
                                <i class="fas fa-trash"></i> Eliminar
                            </button>
                        </div>
                    </div>

                    <!-- Formulario de perfil -->
                    <form id="profile-form">
                        <div class="input-group">
                            <label>Nombre de usuario</label>
                            <input type="text" id="profile-username" required minlength="3" maxlength="20">
                        </div>
                        <div class="input-group">
                            <label>Email</label>
                            <input type="email" id="profile-email" readonly>
                            <small>El email no se puede cambiar</small>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn-secondary" onclick="closeProfileModal()">Cancelar</button>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-save"></i> Guardar Cambios
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Modal para cambiar foto -->
        <div id="picture-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-camera"></i> Cambiar Foto de Perfil</h3>
                    <button class="close-modal" onclick="closePictureModal()">&times;</button>
                </div>
                <div class="picture-options">
                    <!-- Subir archivo -->
                    <div class="picture-option">
                        <h4><i class="fas fa-upload"></i> Subir desde tu dispositivo</h4>
                        <p>Máximo 2MB - JPG, PNG, GIF, WebP</p>
                        <input type="file" id="picture-file" accept="image/*" style="display: none;">
                        <button type="button" class="btn-primary" onclick="document.getElementById('picture-file').click()">
                            <i class="fas fa-folder-open"></i> Seleccionar Archivo
                        </button>
                        <div id="file-preview" style="display: none;">
                            <img id="preview-img" src="" alt="Vista previa" style="max-width: 200px; max-height: 200px; border-radius: 10px; margin: 10px 0;">
                            <div>
                                <button type="button" class="btn-primary" id="upload-file-btn">
                                    <i class="fas fa-upload"></i> Subir Foto
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="divider">O</div>

                    <!-- URL -->
                    <div class="picture-option">
                        <h4><i class="fas fa-link"></i> Usar URL de imagen</h4>
                        <p>Pega la URL de una imagen desde internet</p>
                        <div class="input-group">
                            <input type="url" id="picture-url" placeholder="https://ejemplo.com/imagen.jpg">
                        </div>
                        <button type="button" class="btn-primary" id="upload-url-btn">
                            <i class="fas fa-link"></i> Usar esta URL
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Overlay para móvil -->
        <div class="mobile-overlay" id="mobile-overlay"></div>
    </div>

    <!-- Contenedor de notificaciones -->
    <div id="notifications-container"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html>